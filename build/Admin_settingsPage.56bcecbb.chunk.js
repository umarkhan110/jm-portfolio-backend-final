"use strict";(self.webpackChunkjm_portfolio_backend=self.webpackChunkjm_portfolio_backend||[]).push([[5895],{10608:(ee,b,t)=>{t.r(b),t.d(b,{SettingsPage:()=>Jt,default:()=>qt});var e=t(67294),h=t(68547),i=t(49656),te=t(17034),Q=t(97132),Xe=t(15482),se=t(48474),Pe=t(38683),Ze=t(23724),Ie=t(67838),tt=t(49066),H=t(185),L=t(41580),T=t(11276),Te=t(74571),$=t(75515),Ae=t(7681),W=t(29728),je=t(36182),_=t(17772),B=t(85018),Qe=t(87751),w=t(45697),f=t.n(w);const ze=750,ie=100,We=["image/jpeg","image/png","image/svg+xml"];var Ge=t(73987),ct=t(17973),nt=t(59689),we=t(12028),at=t(96315),st=t(30815),it=t(42866),ne=t(24969),Ye=t(18172);const le={localImage:void 0},Ce=(g=le,d)=>(0,Ye.default)(g,m=>{switch(d.type){case"SET_LOCAL_IMAGE":{m.localImage=d.value;break}default:return m}}),N=({onChangeLogo:g,customLogo:d,goTo:m,Component:E,modalTitle:u,next:O,prev:U,currentStep:X})=>{const[{localImage:ce},J]=(0,e.useReducer)(Ce,le),{formatMessage:ve}=(0,Q.useIntl)(),V=Be=>{J({type:"SET_LOCAL_IMAGE",value:Be})},Fe=()=>{m(null)};return X?e.createElement(it.P,{labelledBy:"modal",onClose:Fe},e.createElement(ne.x,null,e.createElement($.Z,{fontWeight:"bold",as:"h2",id:"modal"},ve(u))),e.createElement(E,{setLocalImage:V,goTo:m,next:O,prev:U,onClose:Fe,asset:ce||d,onChangeLogo:g})):null};N.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},N.propTypes={Component:f().elementType,currentStep:f().string,customLogo:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}),goTo:f().func.isRequired,modalTitle:f().shape({id:f().string,defaultMessage:f().string}),next:f().string,onChangeLogo:f().func.isRequired,prev:f().string};const Ee=N,Y={currentStep:void 0},Ue=(g=Y,d)=>(0,Ye.default)(g,m=>{switch(d.type){case"GO_TO":{m.currentStep=d.to;break}default:return m}});var Oe=t(82777),re=t(60633),Re=t(42761),Ke=t(70004),Je=t(71893),C=t(11047),qe=t(52624),R=t(36856),Z=t(45377),k=t(54574),ae=t(96404),K=t(35957);const me={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},Me={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},$e=g=>new Promise(d=>{const m=new FileReader;m.onload=()=>{const E=new Image;E.onload=function(){d({width:E.width,height:E.height})},E.src=m.result},m.readAsDataURL(g)}),dt=(g,d)=>({ext:g.name.split(".").pop(),size:g.size/1e3,name:g.name,url:URL.createObjectURL(g),rawFile:g,width:d.width,height:d.height}),M=async g=>{let d;if(!We.includes(g.type))throw d=new Error("File format"),d.displayMessage=me,d;const E=await $e(g);if(!(E.width<=ze&&E.height<=ze))throw d=new Error("File sizing"),d.displayMessage=Me,d;const O=dt(g,E);if(!(O.size<=ie))throw d=new Error("File sizing"),d.displayMessage=Me,d;return O},ye=(0,Je.default)(Z._)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,ut=({setLocalImage:g,goTo:d,next:m,onClose:E})=>{const{formatMessage:u}=(0,Q.useIntl)(),[O,U]=(0,e.useState)(!1),[X,ce]=(0,e.useState)(void 0),J=(0,e.useRef)(null),ve=()=>U(!0),V=()=>U(!1),Fe=ot=>{ot.preventDefault(),J.current.click()},Be=async()=>{V();const ot=J.current.files[0];if(ot)try{const lt=await M(ot);g(lt),d(m)}catch(lt){if(lt.displayMessage)ce(u(lt.displayMessage,{size:ie,dimension:ze})),J.current.focus();else throw lt}},Ve=()=>O?"primary500":X?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(L.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(k.g,{name:"logo-upload",error:X},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(Ae.K,{spacing:2},e.createElement(C.k,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:O?"primary100":"neutral100",borderColor:Ve(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:ve,onDragLeave:V},e.createElement(qe.J,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:K.Z,"aria-hidden":!0}),e.createElement(L.x,{paddingTop:3,paddingBottom:5},e.createElement($.Z,{variant:"delta",as:"span"},u({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(ye,{accept:We,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:Be,ref:J,id:"logo-upload"}),e.createElement(W.z,{type:"button",onClick:Fe},u({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(L.x,{paddingTop:6},e.createElement($.Z,{variant:"pi",textColor:"neutral600"},u({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:ie,dimension:ze})))),e.createElement(ae.c,null)))))),e.createElement(R.m,{startActions:e.createElement(W.z,{onClick:E,variant:"tertiary"},u({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};ut.defaultProps={next:null},ut.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const At=ut;var Nt=t(16364),Zt=t(11817);const In=async g=>{try{const d=await Zt.Z.get(g,{responseType:"blob",timeout:8e3});return new File([d.data],d.config.url,{type:d.headers["content-type"]})}catch(d){throw d.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},d}},ht=({goTo:g,next:d,onClose:m,setLocalImage:E})=>{const{formatMessage:u}=(0,Q.useIntl)(),[O,U]=(0,e.useState)(""),[X,ce]=(0,e.useState)(null),J=V=>{U(V.target.value)},ve=async()=>{try{const V=await In(O),Fe=await M(V);E(Fe),g(d)}catch(V){if(V.displayMessage)ce(u(V.displayMessage,{size:ie,dimension:ze}));else throw V}};return e.createElement("form",{onSubmit:V=>{V.preventDefault(),ve()}},e.createElement(L.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(Nt.o,{label:u({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:X,onChange:J,value:O,name:"logo-url"})),e.createElement(R.m,{startActions:e.createElement(W.z,{onClick:m,variant:"tertiary"},u({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(W.z,{type:"submit"},u({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};ht.defaultProps={next:null},ht.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const On=ht,_e=({setLocalImage:g,goTo:d,next:m,onClose:E})=>{const{formatMessage:u}=(0,Q.useIntl)();return e.createElement(Oe.v,{label:u({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(L.x,{paddingLeft:8,paddingRight:8},e.createElement(re.m,null,e.createElement(re.O,null,u({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(re.O,null,u({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(Ke.i,null)),e.createElement(Re.n,null,e.createElement(Re.x,null,e.createElement(At,{onClose:E,setLocalImage:g,goTo:d,next:m})),e.createElement(Re.x,null,e.createElement(On,{onClose:E,setLocalImage:g,goTo:d,next:m}))))};_e.defaultProps={next:null},_e.propTypes={goTo:f().func.isRequired,next:f().string,onClose:f().func.isRequired,setLocalImage:f().func.isRequired};const Fn=_e;var tn=t(99220),nn=t(19093),Bn=t(87535),Ct=t(25001),Nn=t(75517),mt=t(20799),jt=t(41384);const Rt=({asset:g})=>{const{formatMessage:d}=(0,Q.useIntl)();return e.createElement(tn.Z,null,e.createElement(nn.O,null,e.createElement(Bn.H,{size:"S",src:g.url})),e.createElement(Ct.e,null,e.createElement(Nn.a,null,e.createElement(mt.l,null,g.name),e.createElement(mt._,null,`${g.ext.toUpperCase()} - ${g.width}\u2715${g.height}`)),e.createElement(jt.E,null,d({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};Rt.propTypes={asset:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}).isRequired};const zt=Rt,Mt=({onClose:g,asset:d,prev:m,next:E,goTo:u,setLocalImage:O,onChangeLogo:U})=>{const{formatMessage:X}=(0,Q.useIntl)(),ce=()=>{O(void 0),u(m)},J=()=>{U(d),u(E)};return e.createElement(e.Fragment,null,e.createElement(L.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(C.k,{justifyContent:"space-between",paddingBottom:6},e.createElement(C.k,{direction:"column",alignItems:"flex-start"},e.createElement($.Z,{variant:"pi",fontWeight:"bold"},X({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement($.Z,{variant:"pi",textColor:"neutral500"},X({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(W.z,{onClick:ce,variant:"secondary"},X({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(L.x,{maxWidth:(0,h.pxToRem)(180)},e.createElement(zt,{asset:d}))),e.createElement(R.m,{startActions:e.createElement(W.z,{onClick:g,variant:"tertiary"},X({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(W.z,{onClick:J},X({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};Mt.defaultProps={next:null,prev:null},Mt.propTypes={goTo:f().func.isRequired,asset:f().shape({name:f().string,url:f().string,width:f().number,height:f().number,ext:f().string}).isRequired,next:f().string,onClose:f().func.isRequired,onChangeLogo:f().func.isRequired,prev:f().string,setLocalImage:f().func.isRequired};const Ut={upload:{Component:Fn,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:Mt,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},Dt=({canUpdate:g,customLogo:d,defaultLogo:m,hint:E,label:u,onChangeLogo:O,onResetLogo:U})=>{const[{currentStep:X},ce]=(0,e.useReducer)(Ue,Y),{Component:J,next:ve,prev:V,modalTitle:Fe}=Ut[X]||{},{formatMessage:Be}=(0,Q.useIntl)(),Ve=ot=>{ce({type:"GO_TO",to:ot})};return e.createElement(e.Fragment,null,e.createElement(Ge.F,{label:u,selectedSlide:0,hint:E,previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:d?.name||"logo.png",actions:e.createElement(ct.b,null,e.createElement(we.h,{disabled:!g,onClick:()=>Ve(d?"pending":"upload"),label:Be({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(at.default,null)}),d&&e.createElement(we.h,{disabled:!g,onClick:U,label:Be({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(st.Z,null)}))},e.createElement(nt.q,{label:Be({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(L.x,{maxHeight:"40%",maxWidth:"40%",as:"img",src:d?.url||m,alt:Be({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(Ee,{Component:J,currentStep:X,onChangeLogo:O,customLogo:d,goTo:Ve,next:ve,prev:V,modalTitle:Fe}))};Dt.defaultProps={canUpdate:!1,customLogo:null,hint:null},Dt.propTypes={canUpdate:f().bool,customLogo:f().shape({url:f().string,name:f().string}),label:f().string.isRequired,hint:f().string,defaultLogo:f().string.isRequired,onChangeLogo:f().func.isRequired,onResetLogo:f().func.isRequired};const Lt=Dt,xt={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}},authLogo:{display:null,submit:{rawFile:null,isReset:!1}}},sn=(g=xt,d)=>(0,Ye.default)(g,m=>{switch(d.type){case"SET_CUSTOM_MENU_LOGO":{m.menuLogo.display=d.value,m.menuLogo.submit.rawFile=d.value.rawFile;break}case"SET_CUSTOM_AUTH_LOGO":{m.authLogo.display=d.value,m.authLogo.submit.rawFile=d.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{m.menuLogo.display=null,m.menuLogo.submit={rawFile:null,isReset:!0};break}case"RESET_CUSTOM_AUTH_LOGO":{m.authLogo.display=null,m.authLogo.submit={rawFile:null,isReset:!0};break}default:return m}});var $t=t(82492),ln=t.n($t);const cn=(g,d)=>ln()(g,{menuLogo:{display:d.menuLogo},authLogo:{display:d.authLogo}}),pt=(0,e.forwardRef)(({canUpdate:g,projectSettingsStored:d},m)=>{const{formatMessage:E}=(0,Q.useIntl)(),{trackUsage:u}=(0,h.useTracking)(),{logos:{menu:O,auth:U}}=(0,se.um)(),[{menuLogo:X,authLogo:ce},J]=(0,e.useReducer)(sn,xt,()=>cn(xt,d)),ve=Ve=>{J({type:"SET_CUSTOM_MENU_LOGO",value:Ve})},V=()=>{u("didClickResetLogo",{logo:"menu"}),J({type:"RESET_CUSTOM_MENU_LOGO"})},Fe=Ve=>{J({type:"SET_CUSTOM_AUTH_LOGO",value:Ve})},Be=()=>{u("didClickResetLogo",{logo:"auth"}),J({type:"RESET_CUSTOM_AUTH_LOGO"})};return(0,e.useImperativeHandle)(m,()=>({getValues:()=>({menuLogo:X.submit,authLogo:ce.submit})})),e.createElement(L.x,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement($.Z,{variant:"delta",as:"h3"},E({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement($.Z,{variant:"pi",textColor:"neutral600"},E({id:"Settings.application.customization.size-details",defaultMessage:"Max dimension: {dimension}\xD7{dimension}, Max file size: {size}KB"},{dimension:ze,size:ie})),e.createElement(T.r,{paddingTop:4,gap:4},e.createElement(Te.P,{col:6,s:12},e.createElement(Lt,{canUpdate:g,customLogo:X.display,defaultLogo:O.default,hint:E({id:"Settings.application.customization.menu-logo.carousel-hint",defaultMessage:"Replace the logo in the main navigation"}),label:E({id:"Settings.application.customization.carousel.menu-logo.title",defaultMessage:"Menu logo"}),onChangeLogo:ve,onResetLogo:V})),e.createElement(Te.P,{col:6,s:12},e.createElement(Lt,{canUpdate:g,customLogo:ce.display,defaultLogo:U.default,hint:E({id:"Settings.application.customization.auth-logo.carousel-hint",defaultMessage:"Replace the logo in the authentication pages"}),label:E({id:"Settings.application.customization.carousel.auth-logo.title",defaultMessage:"Auth logo"}),onChangeLogo:Fe,onResetLogo:Be}))))});pt.defaultProps={canUpdate:!1,projectSettingsStored:null},pt.propTypes={canUpdate:f().bool,projectSettingsStored:f().shape({menuLogo:f().shape({url:f().string,name:f().string})})};const dn=pt;var Zn=t(68718),kt=t.n(Zn);const Wt=g=>kt()(g,(d,m,E)=>{m&&m.url?d[E]={...m,url:(0,h.prefixFileUrlWithBackendUrl)(m.url)}:d[E]=m},{}),un=async()=>{const{get:g}=(0,h.getFetchClient)(),{data:d}=await g("/admin/project-settings");return Wt(d)},mn=async g=>{const{post:d}=(0,h.getFetchClient)(),{data:m}=await d("/admin/project-settings",g,{headers:{"Content-Type":"multipart/form-data"}});return Wt(m)},Pt=g=>{const d=new FormData;return Object.entries(g).forEach(([m,E])=>{E&&E.rawFile instanceof File&&d.append(m,E.rawFile),E&&E.isReset&&d.append(m,null)}),d},Gt=()=>{const g=(0,e.useRef)(),d=(0,h.useNotification)(),{trackUsage:m}=(0,h.useTracking)(),{formatMessage:E}=(0,Q.useIntl)(),u=(0,Ze.useQueryClient)();(0,h.useFocusWhenNavigate)();const O=(0,h.useAppInfos)(),{shouldUpdateStrapi:U,latestStrapiReleaseTag:X,strapiVersion:ce}=O,{updateProjectSettings:J}=(0,se.um)(),{allowedActions:{canRead:ve,canUpdate:V}}=(0,h.useRBAC)(Qe.Z.settings["project-settings"]),Fe=ve&&V,{data:Be}=(0,Ze.useQuery)("project-settings",un,{enabled:ve}),Ve=O.communityEdition?"app.components.UpgradePlanModal.text-ce":"app.components.UpgradePlanModal.text-ee",ot=(0,Ze.useMutation)(Et=>mn(Et),{async onSuccess({menuLogo:Et,authLogo:St}){await u.invalidateQueries("project-settings",{refetchActive:!0}),J({menuLogo:Et?.url,authLogo:St?.url})}}),lt=Et=>{if(Et.preventDefault(),!V)return;const St=g.current.getValues(),bn=Pt(St);ot.mutate(bn,{onSuccess(){const{menuLogo:Tn,authLogo:_t}=St;Tn.rawFile&&m("didChangeLogo",{logo:"menu"}),_t.rawFile&&m("didChangeLogo",{logo:"auth"}),d({type:"success",message:E({id:"app",defaultMessage:"Saved"})})},onError(){d({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})};return e.createElement(te.A,null,e.createElement(h.SettingsPageTitle,{name:"Application"}),e.createElement(H.o,null,e.createElement("form",{onSubmit:lt},e.createElement(Ie.T,{title:E({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:E({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:Fe&&e.createElement(W.z,{type:"submit",startIcon:e.createElement(B.Z,null)},E({id:"global.save",defaultMessage:"Save"}))}),e.createElement(tt.D,null,e.createElement(Ae.K,{spacing:6},e.createElement(Ae.K,{spacing:5,hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement($.Z,{variant:"delta",as:"h3"},E({id:"global.details",defaultMessage:"Details"})),e.createElement(T.r,{paddingTop:1},e.createElement(Te.P,{col:6,s:12},e.createElement($.Z,{variant:"sigma",textColor:"neutral600"},E({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement($.Z,{as:"p"},"v",ce),e.createElement(je.r,{href:O.communityEdition?"https://discord.strapi.io":"https://support.strapi.io/support/home",isExternal:!0,endIcon:e.createElement(_.Z,null)},E({id:"Settings.application.get-help",defaultMessage:"Get help"}))),e.createElement(Te.P,{col:6,s:12},e.createElement($.Z,{variant:"sigma",textColor:"neutral600"},E({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement($.Z,{as:"p"},E({id:Ve,defaultMessage:`${O.communityEdition?"Community Edition":"Enterprise Edition"}`})))),e.createElement(T.r,{paddingTop:1},e.createElement(Te.P,{col:6,s:12},U&&e.createElement(je.r,{href:`https://github.com/strapi/strapi/releases/tag/${X}`,isExternal:!0,endIcon:e.createElement(_.Z,null)},E({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"}))),e.createElement(Te.P,{col:6,s:12},e.createElement(je.r,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(_.Z,null)},E({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(L.x,{paddingTop:1},e.createElement($.Z,{variant:"sigma",textColor:"neutral600"},E({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement($.Z,{as:"p"},O.nodeVersion))),ve&&Be&&e.createElement(dn,{canUpdate:V,ref:g,projectSettingsStored:Be}))))))};var wt=t(94654),pn=t.n(wt);const gn=g=>pn()(g,m=>m.links).map(m=>(0,Pe.ot)(m.Component,m.to,m.exact||!1)),fn=g=>g.filter(d=>!d.links.every(m=>m.isDisplayed===!1));var It=t(42982),et=t(15861),hn=t(64687),pe=t.n(hn),Kt=function(){return window&&window.strapi&&window.strapi.isEE?t(26789).Z:t(73871).Z}(),Vt=function(){return window&&window.strapi&&window.strapi.isEE?t(64527).Z:t(85302).Z}(),Ht=[{Component:function(){return{default:Vt}},to:"/settings/roles",exact:!0},{Component:function(){return{default:Kt}},to:"/settings/roles/duplicate/:id",exact:!0},{Component:function(){return{default:Kt}},to:"/settings/roles/new",exact:!0},{Component:function(){return(0,et.Z)(pe().mark(function d(){var m;return pe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(2544).then(t.bind(t,92100));case 2:return m=u.sent,u.abrupt("return",m);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/roles/:id",exact:!0},{Component:function(){return(0,et.Z)(pe().mark(function d(){var m;return pe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5199).then(t.bind(t,35097));case 2:return m=u.sent,u.abrupt("return",m);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/users",exact:!0},{Component:function(){return(0,et.Z)(pe().mark(function d(){var m;return pe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(4263).then(t.bind(t,22282));case 2:return m=u.sent,u.abrupt("return",m);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/users/:id",exact:!0},{Component:function(){return(0,et.Z)(pe().mark(function d(){var m;return pe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5162).then(t.bind(t,3672));case 2:return m=u.sent,u.abrupt("return",m);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/webhooks/create",exact:!0},{Component:function(){return(0,et.Z)(pe().mark(function d(){var m;return pe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(5162).then(t.bind(t,9311));case 2:return m=u.sent,u.abrupt("return",m);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/webhooks/:id",exact:!0},{Component:function(){return(0,et.Z)(pe().mark(function d(){var m;return pe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(4121).then(t.bind(t,11199));case 2:return m=u.sent,u.abrupt("return",m);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/webhooks",exact:!0},{Component:function(){return(0,et.Z)(pe().mark(function d(){var m;return pe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.e(8056).then(t.bind(t,8421));case 2:return m=u.sent,u.abrupt("return",m);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/api-tokens",exact:!0},{Component:function(){return(0,et.Z)(pe().mark(function d(){var m;return pe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(4225),t.e(7375),t.e(4299)]).then(t.bind(t,9683));case 2:return m=u.sent,u.abrupt("return",m);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/api-tokens/create",exact:!0},{Component:function(){return(0,et.Z)(pe().mark(function d(){var m;return pe().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Promise.all([t.e(4225),t.e(7375),t.e(92)]).then(t.bind(t,28465));case 2:return m=u.sent,u.abrupt("return",m);case 4:case"end":return u.stop()}},d)}))()},to:"/settings/api-tokens/:id",exact:!0}];const Cn=Ht;var Ot=function(){return window&&window.strapi&&window.strapi.isEE?t(5420).Z:t(35301).Z}();const En=[].concat((0,It.Z)(Ot),(0,It.Z)(Cn));var yn=t(53192),Xt=t(38702),vn=t(34446),Sn=t(29489),Qt=t(52305);const Yt=({menu:g})=>{const{formatMessage:d}=(0,Q.useIntl)(),E=fn(g).map(O=>({...O,title:O.intlLabel,links:O.links.map(U=>({...U,title:U.intlLabel,name:U.id}))})),u=d({id:"global.settings",defaultMessage:"Settings"});return e.createElement(yn.m,{ariaLabel:u},e.createElement(Xt.p,{label:u}),e.createElement(vn.Z,null,E.map(O=>e.createElement(Sn.D,{key:O.id,label:d(O.intlLabel)},O.links.map(U=>e.createElement(Qt.E,{as:i.NavLink,withBullet:U.hasNotification,to:U.to,key:U.id},d(U.intlLabel)))))))};Yt.propTypes={menu:f().array.isRequired};const Ft=Yt;function Jt(){const{settingId:g}=(0,i.useParams)(),{settings:d}=(0,h.useStrapiApp)(),{formatMessage:m}=(0,Q.useIntl)(),{isLoading:E,menu:u}=(0,se.Te)(),O=(0,e.useMemo)(()=>(0,Pe.WW)(En.map(({to:ce,Component:J,exact:ve})=>(0,Pe.ot)(J,ce,ve))),[]),U=gn(d);if(E)return e.createElement(h.LoadingIndicatorPage,null);if(!g)return e.createElement(i.Redirect,{to:"/settings/application-infos"});const X=m({id:"global.settings",defaultMessage:"Settings"});return e.createElement(te.A,{sideNav:e.createElement(Ft,{menu:u})},e.createElement(Xe.Helmet,{title:X}),e.createElement(i.Switch,null,e.createElement(i.Route,{path:"/settings/application-infos",component:Gt,exact:!0}),O,U))}const qt=(0,e.memo)(Jt)},73871:(ee,b,t)=>{t.d(b,{Z:()=>te});var e=t(67294),h=t(49656);const te=()=>e.createElement(h.Redirect,{to:"/404"})},79578:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},35820:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},53558:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},56195:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},99047:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},28834:(ee,b,t)=>{t.d(b,{Z:()=>Ro});var e=t(67294),h=t(45697),i=t.n(h),te=t(68547),Q=t(82777),Xe=t(60633),se=t(42761),Pe=t(18721),Ze=t.n(Pe),Ie=t(41609),tt=t.n(Ie),H=t(97132),L=t(41580),T=t(71893),Te=t(89734),$=t.n(Te),Ae=t(70885),W=t(66942),je=t(52337),_=t(41451),B=t(11047),Qe=t(27361),w=t.n(Qe),f=t(57557),ze=t.n(f),ie=t(48474),We=t(78114),Ge=t(29728);const ct=T.default.div`
  position: relative;

  ${({hasConditions:o,disabled:n,theme:a})=>o&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${n?a.colors.neutral100:a.colors.primary600};
    }
  `}
`,nt=({onClick:o,className:n,hasConditions:a,variant:s})=>{const{formatMessage:l}=(0,H.useIntl)();return e.createElement(ct,{hasConditions:a,className:n},e.createElement(Ge.z,{variant:s,startIcon:e.createElement(We.Z,null),onClick:o},l({id:"global.settings",defaultMessage:"Settings"})))};nt.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},nt.propTypes={onClick:i().func.isRequired,className:i().string,hasConditions:i().bool,variant:i().string};const we=(0,T.default)(nt)``;var at=t(42866),st=t(24969),it=t(59946),ne=t(36856),Ye=t(2407),le=t(75515),x=t(18172),Ce=t(7739),N=t.n(Ce),Ee=t(11700),Y=t.n(Ee),oe=t(38953);const Ue=o=>Object.values(o).map(n=>Object.entries(n).filter(([,a])=>a).map(([a])=>a)).flat(),Oe=o=>o.reduce((n,[a,s])=>(n.push({label:Y()(a),children:s.map(l=>({label:l.displayName,value:l.id}))}),n),[]),re=(o,n)=>o.map(([,a])=>a).flat().reduce((a,s)=>({[s.id]:n.includes(s.id),...a}),{});var Re=function(){return window&&window.strapi&&window.strapi.isEE?t(53273).Z:t(79578).Z}(),Ke=function(n){var a=n.arrayOfOptionsGroupedByCategory,s=n.isFormDisabled,l=n.isGrey,r=n.label,c=n.name,p=n.onChange,y=n.value,v=(0,H.useIntl)(),S=v.formatMessage,A=function(j){p(c,re(a,j))};return e.createElement(B.k,{as:"li",background:l?"neutral100":"neutral0",paddingBottom:3,paddingTop:3},e.createElement(B.k,{paddingLeft:6,style:{width:180}},e.createElement(le.Z,{variant:"sigma",textColor:"neutral600"},S({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(le.Z,{variant:"sigma",title:r,textColor:"primary600",ellipsis:!0},S({id:"Settings.roles.form.permissions.".concat(r.toLowerCase()),defaultMessage:r})),e.createElement(le.Z,{variant:"sigma",textColor:"neutral600"},"\xA0",S({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(L.x,{style:{maxWidth:430,width:"100%"}},e.createElement(oe.Q,{id:c,customizeContent:function(j){return"".concat(j.length," currently selected")},onChange:A,value:Ue(y),options:Oe(a),disabled:s||Re})))};Ke.propTypes={arrayOfOptionsGroupedByCategory:i().array.isRequired,isFormDisabled:i().bool.isRequired,isGrey:i().bool.isRequired,label:i().string.isRequired,name:i().string.isRequired,value:i().object.isRequired,onChange:i().func.isRequired};const Je=Ke;var C=t(96486);const qe=(o,n)=>o.reduce((a,s)=>(a[s.id]=(0,C.get)(n,s.id,!1),a),{}),R=(o,n)=>o.reduce((a,s)=>{const[l,r]=s,c=qe(r,n);return a[l]=c,a},{}),k=(o,n,a)=>o.reduce((s,l)=>{const r=(0,C.get)(n,[...l.pathToConditionsObject,"conditions"],{}),c=R(a,r);return s[l.pathToConditionsObject.join("..")]=c,s},{}),ae=({actions:o,headerBreadCrumbs:n,isFormDisabled:a,onClosed:s,onToggle:l})=>{const{formatMessage:r}=(0,H.useIntl)(),{availableConditions:c,modifiedData:p,onChangeConditions:y}=(0,ie.$_)(),v=(0,e.useMemo)(()=>Object.entries(N()(c,"category")),[c]),S=o.filter(({isDisplayed:D,hasSomeActionsSelected:F,hasAllActionsSelected:G})=>D&&(F||G)),A=(0,e.useMemo)(()=>k(S,p,v),[S,p,v]),[P,j]=(0,e.useState)(A),I=(D,F)=>{j((0,x.default)(G=>{G[D]||(G[D]={}),G[D].default||(G[D].default={}),G[D].default=F}))},z=()=>{const D=Object.entries(P).reduce((F,G)=>{const[de,He]=G,Se=Object.values(He).reduce((fe,De)=>({...fe,...De}),{});return F[de]=Se,F},{});y(D),l()};return e.createElement(at.P,{labelledBy:"condition-modal-breadcrumbs",onClose:s},e.createElement(st.x,null,e.createElement(Ye.O,{id:"condition-modal-breadcrumbs",label:n.join(", ")},n.map(D=>e.createElement(Ye.$,{key:D},Y()(r({id:D,defaultMessage:D})))))),e.createElement(it.f,null,S.length===0&&e.createElement(le.Z,null,r({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,S.map(({actionId:D,label:F,pathToConditionsObject:G},de)=>{const He=G.join("..");return e.createElement(Je,{key:D,arrayOfOptionsGroupedByCategory:v,label:F,isFormDisabled:a,isGrey:de%2===0,name:He,onChange:I,value:w()(P,He,{})})}))),e.createElement(ne.m,{startActions:e.createElement(Ge.z,{variant:"tertiary",onClick:l},r({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(Ge.z,{onClick:z},r({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};ae.propTypes={actions:i().arrayOf(i().shape({actionId:i().string.isRequired,checkboxName:i().string,hasSomeActionsSelected:i().bool.isRequired,hasAllActionsSelected:i().bool,isDisplayed:i().bool.isRequired,label:i().string})).isRequired,headerBreadCrumbs:i().arrayOf(i().string).isRequired,isFormDisabled:i().bool.isRequired,onClosed:i().func.isRequired,onToggle:i().func.isRequired};const K=ae,me=`${120/16}rem`,Me=`${200/16}rem`,$e=`${53/16}rem`,M=T.default.div`
  width: ${me};
`,ut=(0,T.default)(B.k)`
  padding-right: ${({theme:o})=>o.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:o})=>o&&"cursor: pointer;"}
`,At=({children:o,isCollapsable:n,isActive:a,isFormDisabled:s,label:l,onChange:r,onClick:c,checkboxName:p,someChecked:y,value:v})=>{const{formatMessage:S}=(0,H.useIntl)();return e.createElement(B.k,{alignItems:"center",paddingLeft:6,style:{width:Me,flexShrink:0}},e.createElement(L.x,{paddingRight:2},e.createElement(_.C,{name:p,"aria-label":S({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:l}),disabled:s,onValueChange:A=>r({target:{name:p,value:A}}),indeterminate:y,value:v})),e.createElement(ut,{title:l,alignItems:"center",isCollapsable:n,...n&&{onClick:c,"aria-expanded":a,onKeyDown:({key:A})=>(A==="Enter"||A===" ")&&c(),tabIndex:0,role:"button"}},e.createElement(le.Z,{fontWeight:a?"bold":"",textColor:a?"primary600":"neutral800",ellipsis:!0},Y()(l)),o))};At.defaultProps={children:null,checkboxName:"",onChange(){},value:!1,someChecked:!1,isCollapsable:!1},At.propTypes={checkboxName:i().string,children:i().node,label:i().string.isRequired,isCollapsable:i().bool,isFormDisabled:i().bool.isRequired,onChange:i().func,onClick:i().func.isRequired,someChecked:i().bool,value:i().bool,isActive:i().bool.isRequired};const Nt=(0,e.memo)(At),Zt=o=>(0,C.isObject)(o)?(0,C.flattenDeep)(Object.values(o).map(n=>(0,C.isObject)(n)?Zt(n):n)):[],ft=Zt,ht=o=>o?Object.keys(o).reduce((n,a)=>(a!=="conditions"&&(n[a]=o[a]),n),{}):null,_e=o=>{const n=ht(o),a=ft(n);if(!a.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const s=a.every(r=>r),l=a.some(r=>r)&&!s;return{hasAllActionsSelected:s,hasSomeActionsSelected:l}},tn=(o,n,a)=>o.map(({actionId:s,isDisplayed:l,applyToProperties:r,label:c})=>{if(!l)return{actionId:s,hasSomeActionsSelected:!1,isDisplayed:l};const p=[...a.split(".."),s],y=(0,C.isEmpty)(r)?[...p,"properties","enabled"]:p,v=y.join(".."),S=(0,C.get)(n,[...p,"conditions"],null),A=ft(S).some(z=>z);if((0,C.isEmpty)(r)){const z=(0,C.get)(n,y,!1);return{actionId:s,checkboxName:v,hasAllActionsSelected:z,hasConditions:A,hasSomeActionsSelected:z,isDisplayed:l,isParentCheckbox:!1,label:c,pathToConditionsObject:p}}const P=(0,C.get)(n,y,null),{hasAllActionsSelected:j,hasSomeActionsSelected:I}=_e(P);return{actionId:s,checkboxName:v,hasAllActionsSelected:j,hasConditions:A,hasSomeActionsSelected:I,isDisplayed:l,isParentCheckbox:!0,label:c,pathToConditionsObject:p}});var nn=t(12645);const Ct=(0,T.default)(nn.default)`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:o})=>o?"180":"0"}deg);
  margin-left: ${({theme:o})=>o.spaces[2]};
`,mt=o=>`
  ${le.Z} {
    color: ${o.colors.primary600};
    font-weight: ${o.fontWeights.bold}
  }
  ${Ct} {
    display: block;
    path {
      fill: ${o.colors.primary600}
    };
  }
`;var jt=function(){return window&&window.strapi&&window.strapi.isEE?t(20591).Z:t(56195).Z}(),Rt=function o(n,a){return`
  `.concat(zt,` {
    background-color: `).concat(n.colors.primary100,`;
    color: `).concat(n.colors.primary600,`;
    border-radius: `).concat(a?"2px 2px 0 0":"2px",`;
  }
  `).concat(an,` {
    display: flex;
  }
  `).concat(we,` {
    display: block;
  }
  &:hover {
   `).concat(mt(n),`
  }

  &:focus-within {
    `).concat(function(s){var l=s.theme,r=s.isActive;return o(l,r)},`
  }
  
`)},zt=T.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],$e,function(o){var n=o.isGrey,a=o.theme;return n?a.colors.neutral100:a.colors.neutral0}),Mt=T.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],we,function(o){var n=o.isActive,a=o.theme;return n&&Rt(a,n)},function(o){var n=o.theme,a=o.isActive;return Rt(n,a)}),on=(0,T.default)(B.k).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],me),an=(0,T.default)(L.x).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],function(o){var n=o.theme;return n.colors.primary600}),Ut=T.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],function(o){var n=o.theme;return n.colors.primary600}),Dt=(0,T.default)(L.x).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),Lt=function(n){var a=n.availableActions,s=n.isActive,l=n.isGrey,r=n.isFormDisabled,c=n.label,p=n.onClickToggle,y=n.pathToData,v=(0,e.useState)(!1),S=(0,Ae.Z)(v,2),A=S[0],P=S[1],j=(0,H.useIntl)(),I=j.formatMessage,z=(0,ie.$_)(),D=z.modifiedData,F=z.onChangeParentCheckbox,G=z.onChangeSimpleCheckbox,de=function(){P(function(ge){return!ge})},He=function(){P(!1)},Se=w()(D,y.split(".."),{}),fe=(0,e.useMemo)(function(){return Object.keys(Se).reduce(function(q,ge){return q[ge]=ze()(Se[ge],"conditions"),q},{})},[Se]),De=_e(fe),be=De.hasAllActionsSelected,yt=De.hasSomeActionsSelected,ue=(0,e.useMemo)(function(){return tn(a,D,y)},[a,D,y]),Le=ue.some(function(q){var ge=q.hasConditions;return ge});return e.createElement(Mt,{isActive:s},e.createElement(zt,{isGrey:l},e.createElement(Nt,{isCollapsable:!0,isFormDisabled:r,label:c,checkboxName:y,onChange:F,onClick:p,someChecked:yt,value:be,isActive:s},e.createElement(an,{paddingLeft:2},s?e.createElement(je.Z,null):e.createElement(W.Z,null))),e.createElement(B.k,{style:{flex:1}},ue.map(function(q){var ge=q.actionId,he=q.hasConditions,xe=q.hasAllActionsSelected,Ne=q.hasSomeActionsSelected,gt=q.isDisplayed,ke=q.isParentCheckbox,rt=q.checkboxName,bt=q.label;return gt?ke?e.createElement(on,{key:ge,justifyContent:"center",alignItems:"center"},he&&e.createElement(Ut,null),e.createElement(_.C,{disabled:r||jt,name:rt,"aria-label":I({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(bt," ").concat(c)}),onValueChange:function(vt){F({target:{name:rt,value:vt}})},indeterminate:Ne,value:xe})):e.createElement(on,{key:ge,justifyContent:"center",alignItems:"center"},he&&e.createElement(Ut,null),e.createElement(_.C,{disabled:r||jt,indeterminate:he,name:rt,onValueChange:function(vt){G({target:{name:rt,value:vt}})},value:xe})):e.createElement(M,{key:ge})})),A&&e.createElement(K,{headerBreadCrumbs:[c,"Settings.permissions.conditions.conditions"],actions:ue,isFormDisabled:r,onClosed:He,onToggle:de})),e.createElement(Dt,null,e.createElement(we,{onClick:de,hasConditions:Le})))};Lt.propTypes={availableActions:i().array.isRequired,isActive:i().bool.isRequired,isGrey:i().bool.isRequired,isFormDisabled:i().bool.isRequired,label:i().string.isRequired,onClickToggle:i().func.isRequired,pathToData:i().string.isRequired};const xt=Lt,sn=(o,n)=>o.map(a=>{const s=Array.isArray(a.applyToProperties)&&a.applyToProperties.indexOf(n)!==-1&&a.isDisplayed;return{label:a.label,actionId:a.actionId,isActionRelatedToCurrentProperty:s}}),$t=(0,T.default)(B.k)`
  width: ${me};
  flex-shrink: 0;
`,ln=(0,T.default)(B.k)`
  width: ${Me};
  height: ${$e};
  flex-shrink: 0;
`,rn=({headers:o,label:n})=>{const{formatMessage:a}=(0,H.useIntl)(),s=a({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:n});return e.createElement(B.k,null,e.createElement(ln,{alignItems:"center",paddingLeft:6},e.createElement(le.Z,{variant:"sigma",textColor:"neutral500"},s)),o.map(l=>l.isActionRelatedToCurrentProperty?e.createElement($t,{justifyContent:"center",key:l.label},e.createElement(le.Z,{variant:"sigma",textColor:"neutral500"},a({id:`Settings.roles.form.permissions.${l.label.toLowerCase()}`,defaultMessage:l.label}))):e.createElement($t,{key:l.label})))};rn.propTypes={headers:i().arrayOf(i().shape({label:i().string.isRequired,isActionRelatedToCurrentProperty:i().bool.isRequired})).isRequired,label:i().string.isRequired};const cn=rn;var pt=t(42982);const dn=T.default.span`
  color: ${({theme:o})=>o.colors.danger700};
  padding-left: ${({theme:o})=>o.spaces[1]}px;
`,kt=()=>e.createElement(dn,null,"*"),Wt=(o,n)=>o.map(a=>{const s=Array.isArray(a.subjects)&&a.subjects.indexOf(n)!==-1;return{...a,isDisplayed:s}});var un=t(87462);const mn=(0,T.default)(L.x)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:o})=>o.colors.primary200};
    display: block;
  }
`,jn=T.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:o,color:n})=>o.colors[n]};
  }
`,Pt=o=>e.createElement(mn,null,e.createElement(jn,{width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o},e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));Pt.defaultProps={fill:"primary200"},Pt.propTypes={fill:i().string};const zn=(0,e.memo)(Pt);var Gt=function(){return window&&window.strapi&&window.strapi.isEE?t(76766).Z:t(53558).Z}(),wt=(0,T.default)(B.k).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],me),pn=(0,T.default)(B.k).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],$e),Un=(0,T.default)(L.x).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),gn=(0,T.default)(L.x).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],function(o){var n=o.isVisible,a=o.theme;return n?"4px solid ".concat(a.colors.primary200):"4px solid transparent"}),$n=(0,T.default)(B.k).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],function(o){var n=o.theme;return n.spaces[4]},function(o){var n=o.level;return 145-n*36},function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ct,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(mt(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&mt(a)}),fn=T.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],function(o){var n=o.theme;return n.spaces[2]},function(o){var n=o.theme;return n.spaces[2]},4/16,function(o){var n=o.theme;return n.colors.primary200}),It=function o(n){var a=n.childrenForm,s=n.isFormDisabled,l=n.recursiveLevel,r=n.pathToDataFromActionRow,c=n.propertyActions,p=n.parentName,y=n.propertyName,v=(0,H.useIntl)(),S=v.formatMessage,A=(0,ie.$_)(),P=A.modifiedData,j=A.onChangeParentCheckbox,I=A.onChangeSimpleCheckbox,z=(0,e.useState)(null),D=(0,Ae.Z)(z,2),F=D[0],G=D[1],de=function(fe){G(function(De){return De===fe?null:fe})},He=(0,e.useMemo)(function(){return F?a.find(function(Se){var fe=Se.value;return fe===F}):null},[F,a]);return e.createElement(Un,null,e.createElement(fn,null),a.map(function(Se,fe){var De=Se.label,be=Se.value,yt=Se.required,ue=Se.children,Le=fe+1<a.length,q=Array.isArray(ue),ge=F===be;return e.createElement(gn,{key:be,isVisible:Le},e.createElement(pn,null,e.createElement(zn,{color:"primary200"}),e.createElement(B.k,{style:{flex:1}},e.createElement($n,{level:l,isActive:ge,isCollapsable:q},e.createElement(ut,(0,un.Z)({alignItems:"center",isCollapsable:q},q&&{onClick:function(){return de(be)},"aria-expanded":ge,onKeyDown:function(xe){var Ne=xe.key;return(Ne==="Enter"||Ne===" ")&&de(be)},tabIndex:0,role:"button"},{title:De}),e.createElement(le.Z,{ellipsis:!0},Y()(De)),yt&&e.createElement(kt,null),e.createElement(Ct,{$isActive:ge}))),e.createElement(B.k,{style:{flex:1}},c.map(function(he){var xe=he.actionId,Ne=he.label,gt=he.isActionRelatedToCurrentProperty;if(!gt)return e.createElement(M,{key:xe});var ke=[].concat((0,pt.Z)(r.split("..")),[xe,"properties",y],(0,pt.Z)(p.split("..")),[be]),rt=w()(P,ke,!1);if(!ue)return e.createElement(wt,{key:Ne,justifyContent:"center",alignItems:"center"},e.createElement(_.C,{disabled:s||Gt,name:ke.join(".."),"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(p," ").concat(De," ").concat(Ne)}),onValueChange:function(Bt){I({target:{name:ke.join(".."),value:Bt}})},value:rt}));var bt=_e(rt),Tt=bt.hasAllActionsSelected,vt=bt.hasSomeActionsSelected;return e.createElement(wt,{key:Ne,justifyContent:"center",alignItems:"center"},e.createElement(_.C,{key:Ne,disabled:s||Gt,name:ke.join(".."),"aria-label":S({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(p," ").concat(De," ").concat(Ne)}),onValueChange:function(Bt){j({target:{name:ke.join(".."),value:Bt}})},value:Tt,indeterminate:vt}))})))),He&&ge&&e.createElement(L.x,{paddingBottom:2},e.createElement(o,{isFormDisabled:s,parentName:"".concat(p,"..").concat(be),pathToDataFromActionRow:r,propertyActions:c,propertyName:y,recursiveLevel:l+1,childrenForm:He.children})))}))};It.propTypes={childrenForm:i().array.isRequired,isFormDisabled:i().bool.isRequired,parentName:i().string.isRequired,pathToDataFromActionRow:i().string.isRequired,propertyActions:i().array.isRequired,propertyName:i().string.isRequired,recursiveLevel:i().number.isRequired};const et=(0,e.memo)(It),hn=o=>o.reduce((a,s)=>(s.isActionRelatedToCurrentProperty&&a.push(s.actionId),a),[]),Kt=(o,n,a,s,l)=>{const c=hn(o).reduce((p,y)=>{const v=[...a.split(".."),y,"properties",s,l],S=(0,C.get)(n,v,!1);return p[y]=S,p},{});return _e(c)};var Vt=function(){return window&&window.strapi&&window.strapi.isEE?t(74512).Z:t(35820).Z}(),Ht=(0,T.default)(B.k).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],me),Cn=(0,T.default)(B.k).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],$e,function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(Ct,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(mt(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&mt(a)}),Ot=function(n){var a=n.childrenForm,s=n.label,l=n.isFormDisabled,r=n.name,c=n.required,p=n.pathToData,y=n.propertyActions,v=n.propertyName,S=n.isOdd,A=(0,H.useIntl)(),P=A.formatMessage,j=(0,e.useState)(null),I=(0,Ae.Z)(j,2),z=I[0],D=I[1],F=(0,ie.$_)(),G=F.modifiedData,de=F.onChangeCollectionTypeLeftActionRowCheckbox,He=F.onChangeParentCheckbox,Se=F.onChangeSimpleCheckbox,fe=z===r,De=(0,e.useMemo)(function(){return Array.isArray(a)?a:[]},[a]),be=De.length>0,yt=(0,e.useCallback)(function(){be&&D(function(he){return he===r?null:r})},[be,r]),ue=function(xe){var Ne=xe.target.value;de(p,v,r,Ne)},Le=(0,e.useMemo)(function(){return Kt(y,G,p,v,r)},[y,G,p,v,r]),q=Le.hasAllActionsSelected,ge=Le.hasSomeActionsSelected;return e.createElement(e.Fragment,null,e.createElement(Cn,{alignItems:"center",isCollapsable:be,isActive:fe,background:S?"neutral100":"neutral0"},e.createElement(B.k,null,e.createElement(Nt,{onChange:ue,onClick:yt,isCollapsable:be,isFormDisabled:l,label:s,someChecked:ge,value:q,isActive:fe},c&&e.createElement(kt,null),e.createElement(Ct,{$isActive:fe})),e.createElement(B.k,null,y.map(function(he){var xe=he.label,Ne=he.isActionRelatedToCurrentProperty,gt=he.actionId;if(!Ne)return e.createElement(M,{key:xe});var ke=[].concat((0,pt.Z)(p.split("..")),[gt,"properties",v,r]);if(!be){var rt=w()(G,ke,!1);return e.createElement(Ht,{key:gt,justifyContent:"center",alignItems:"center"},e.createElement(_.C,{disabled:l||Vt,name:ke.join(".."),"aria-label":P({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(r," ").concat(xe)}),onValueChange:function(Pn){Se({target:{name:ke.join(".."),value:Pn}})},value:rt}))}var bt=w()(G,ke,{}),Tt=_e(bt),vt=Tt.hasAllActionsSelected,xn=Tt.hasSomeActionsSelected;return e.createElement(Ht,{key:xe,justifyContent:"center",alignItems:"center"},e.createElement(_.C,{disabled:l||Vt,name:ke.join(".."),onValueChange:function(Pn){He({target:{name:ke.join(".."),value:Pn}})},"aria-label":P({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(r," ").concat(xe)}),value:vt,indeterminate:xn}))})))),fe&&e.createElement(et,{childrenForm:De,isFormDisabled:l,parentName:r,pathToDataFromActionRow:p,propertyName:v,propertyActions:y,recursiveLevel:0}))};Ot.defaultProps={childrenForm:[],required:!1},Ot.propTypes={childrenForm:i().array,label:i().string.isRequired,isFormDisabled:i().bool.isRequired,name:i().string.isRequired,pathToData:i().string.isRequired,propertyActions:i().array.isRequired,propertyName:i().string.isRequired,required:i().bool,isOdd:i().bool.isRequired};const En=(0,e.memo)(Ot),yn=T.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,Xt=({availableActions:o,childrenForm:n,isFormDisabled:a,label:s,pathToData:l,propertyName:r})=>{const c=(0,e.useMemo)(()=>sn(o,r),[o,r]);return e.createElement(yn,null,e.createElement(cn,{label:s,headers:c}),e.createElement(L.x,null,n.map(({children:p,label:y,value:v,required:S},A)=>e.createElement(En,{childrenForm:p,key:v,label:y,isFormDisabled:a,name:v,required:S,propertyActions:c,pathToData:l,propertyName:r,isOdd:A%2===0}))))};Xt.propTypes={childrenForm:i().array.isRequired,availableActions:i().array.isRequired,isFormDisabled:i().bool.isRequired,label:i().string.isRequired,pathToData:i().string.isRequired,propertyName:i().string.isRequired};const vn=Xt,Sn=T.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:o,isActive:n})=>n&&`border: 1px solid ${o.colors.primary600};`}
`,Qt=({allActions:o,contentTypeName:n,label:a,index:s,isActive:l,isFormDisabled:r,onClickToggleCollapse:c,pathToData:p,properties:y})=>{const v=(0,e.useCallback)(()=>{c(n)},[n,c]),S=(0,e.useMemo)(()=>Wt(o,n),[o,n]);return e.createElement(Sn,{isActive:l},e.createElement(xt,{availableActions:S,isActive:l,isGrey:s%2===0,isFormDisabled:r,label:a,onClickToggle:v,pathToData:p}),l&&y.map(({label:A,value:P,children:j})=>e.createElement(vn,{availableActions:S,childrenForm:j,isFormDisabled:r,label:A,pathToData:p,propertyName:P,key:P})))};Qt.propTypes={allActions:i().array.isRequired,contentTypeName:i().string.isRequired,index:i().number.isRequired,isActive:i().bool.isRequired,isFormDisabled:i().bool.isRequired,label:i().string.isRequired,onClickToggleCollapse:i().func.isRequired,pathToData:i().string.isRequired,properties:i().array.isRequired};const Yt=Qt,Ft=({actions:o,isFormDisabled:n,pathToData:a,subjects:s})=>{const[l,r]=(0,e.useState)(null),c=p=>{r(l===p?null:p)};return s.map(({uid:p,label:y,properties:v},S)=>e.createElement(Yt,{allActions:o,key:p,contentTypeName:p,label:y,isActive:l===p,isFormDisabled:n,index:S,onClickToggleCollapse:c,pathToData:`${a}..${p}`,properties:v}))};Ft.defaultProps={actions:[],subjects:[]},Ft.propTypes={actions:i().array.isRequired,isFormDisabled:i().bool.isRequired,pathToData:i().string.isRequired,subjects:i().arrayOf(i().shape({uid:i().string.isRequired,label:i().string.isRequired,properties:i().array.isRequired}))};const Jt=(0,e.memo)(Ft);var qt=t(7681);const d=o=>o.filter(({subjects:n})=>n&&n.length),m=o=>o.map(({actionId:n})=>n),E=(o,n)=>o.reduce((a,s)=>(Object.keys(n).forEach(l=>{const r=(0,C.get)(n,[l,s],{}),c={[l]:ht(r)};a[s]?a[s]={...a[s],...c}:a[s]=c}),a),{}),O=(o,n)=>{const a=m(o),s=E(a,n);return Object.keys(s).reduce((r,c)=>(r[c]=_e(s[c]),r),{})};var U=function(){return window&&window.strapi&&window.strapi.isEE?t(85822).Z:t(99047).Z}(),X=(0,T.default)(qt.K).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],me),ce=function(n){var a=n.actions,s=n.isFormDisabled,l=n.kind,r=(0,H.useIntl)(),c=r.formatMessage,p=(0,ie.$_)(),y=p.modifiedData,v=p.onChangeCollectionTypeGlobalActionCheckbox,S=(0,e.useMemo)(function(){return d(a)},[a]),A=(0,e.useMemo)(function(){return O(S,y[l])},[y,S,l]);return e.createElement(L.x,{paddingBottom:4,paddingTop:6,style:{paddingLeft:Me}},e.createElement(qt.K,{horizontal:!0,spacing:0},S.map(function(P){var j=P.label,I=P.actionId;return e.createElement(X,{key:I,spacing:3},e.createElement(le.Z,{variant:"sigma",textColor:"neutral500"},c({id:"Settings.roles.form.permissions.".concat(j.toLowerCase()),defaultMessage:j})),e.createElement(_.C,{disabled:s||U,onValueChange:function(D){v(l,I,D)},name:I,"aria-label":c({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:c({id:"Settings.roles.form.permissions.".concat(j.toLowerCase()),defaultMessage:j})}),value:w()(A,[I,"hasAllActionsSelected"],!1),indeterminate:w()(A,[I,"hasSomeActionsSelected"],!1)}))})))};ce.defaultProps={actions:[]},ce.propTypes={actions:i().arrayOf(i().shape({label:i().string.isRequired,actionId:i().string.isRequired,subjects:i().array.isRequired})),isFormDisabled:i().bool.isRequired,kind:i().string.isRequired};const J=(0,e.memo)(ce),ve=(0,T.default)(L.x)`
  overflow-x: auto;
`,V=({isFormDisabled:o,kind:n,layout:{actions:a,subjects:s}})=>{const l=$()([...s],"label");return e.createElement(ve,{background:"neutral0"},e.createElement(J,{actions:a,kind:n,isFormDisabled:o}),e.createElement(Jt,{actions:a,isFormDisabled:o,pathToData:n,subjects:l}))};V.propTypes={isFormDisabled:i().bool.isRequired,kind:i().string.isRequired,layout:i().shape({actions:i().array,subjects:i().arrayOf(i().shape({uid:i().string.isRequired,label:i().string.isRequired,properties:i().array.isRequired}))}).isRequired};const Fe=(0,e.memo)(V);var Be=t(47713);const Ve=({children:o,value:n})=>e.createElement(Be.$l.Provider,{value:n},o);Ve.propTypes={children:i().node.isRequired,value:i().exact({availableConditions:i().array.isRequired,modifiedData:i().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:i().func.isRequired,onChangeConditions:i().func.isRequired,onChangeSimpleCheckbox:i().func.isRequired,onChangeParentCheckbox:i().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:i().func.isRequired}).isRequired};const ot=Ve;var lt=t(48734),Et=t(74756),St=t(63081),bn=t(11276),Tn=t(74571),_t=t(36213);const ao=(o,n,a)=>o.map(s=>{const l=[...a,s.action,"properties","enabled"],r=(0,C.get)(n,l,!1),c=(0,C.get)(n,[...a,s.action,"conditions"],{}),p=ft(c).some(y=>y);return{...s,isDisplayed:r,checkboxName:l.join(".."),hasSomeActionsSelected:r,value:r,hasConditions:p,label:s.displayName,actionId:s.action,pathToConditionsObject:[...a,s.action]}}),so=o=>{const n=Object.entries(o).reduce((s,l)=>{const[r,{conditions:c}]=l;return s[r]=c,s},{});return ft(n).some(s=>s)};var An=function(){return window&&window.strapi&&window.strapi.isEE?t(8629).Z:t(34341).Z}(),io=T.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],function(o){var n=o.theme;return n.colors.neutral150}),lo=T.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],function(o){var n=o.hasConditions,a=o.disabled,s=o.theme;return n&&`
    &:before {
      content: '';
      position: absolute;
      top: `.concat(-4/16,`rem;
      left: `).concat(-8/16,`rem;
      width: `).concat(6/16,`rem;
      height: `).concat(6/16,`rem;
      border-radius: `).concat(20/16,`rem;
      background: `).concat(a?s.colors.neutral100:s.colors.primary600,`;
    }
  `)}),kn=function(n){var a=n.categoryName,s=n.isFormDisabled,l=n.subCategoryName,r=n.actions,c=n.pathToData,p=(0,e.useState)(!1),y=(0,Ae.Z)(p,2),v=y[0],S=y[1],A=(0,ie.$_)(),P=A.modifiedData,j=A.onChangeParentCheckbox,I=A.onChangeSimpleCheckbox,z=(0,H.useIntl)(),D=z.formatMessage,F=w()(P,c,{}),G=(0,e.useMemo)(function(){return Object.keys(F).reduce(function(ue,Le){return ue[Le]=ht(F[Le]),ue},{})},[F]),de=_e(G),He=de.hasAllActionsSelected,Se=de.hasSomeActionsSelected,fe=function(){S(function(Le){return!Le})},De=function(){S(!1)},be=ao(r,P,c),yt=so(w()(P,(0,pt.Z)(c),{}));return e.createElement(e.Fragment,null,e.createElement(L.x,null,e.createElement(B.k,{justifyContent:"space-between",alignItems:"center"},e.createElement(L.x,{paddingRight:4},e.createElement(le.Z,{variant:"sigma",textColor:"neutral600"},l)),e.createElement(io,null),e.createElement(L.x,{paddingLeft:4},e.createElement(_t.X,{name:c.join(".."),disabled:s||An,onValueChange:function(Le){j({target:{name:c.join(".."),value:Le}})},indeterminate:Se,value:He},D({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(B.k,{paddingTop:6,paddingBottom:6},e.createElement(bn.r,{gap:2,style:{flex:1}},be.map(function(ue){var Le=ue.checkboxName,q=ue.value,ge=ue.action,he=ue.displayName,xe=ue.hasConditions;return e.createElement(Tn.P,{col:3,key:ge},e.createElement(lo,{disabled:s||An,hasConditions:xe},e.createElement(_t.X,{name:Le,disabled:s||An,onValueChange:function(gt){I({target:{name:Le,value:gt}})},value:q},he)))})),e.createElement(we,{hasConditions:yt,onClick:fe}))),v&&e.createElement(K,{headerBreadCrumbs:[a,l],actions:be,isFormDisabled:s,onClosed:De,onToggle:fe}))};kn.propTypes={actions:i().array.isRequired,categoryName:i().string.isRequired,isFormDisabled:i().bool.isRequired,subCategoryName:i().string.isRequired,pathToData:i().array.isRequired};const ro=kn,Rn=({childrenForm:o,kind:n,name:a,isOpen:s,isFormDisabled:l,isWhite:r,onOpenCategory:c,pathToData:p})=>{const{formatMessage:y}=(0,H.useIntl)(),v=()=>{c(a)},S=(0,e.useMemo)(()=>a.split("::").pop(),[a]);return e.createElement(lt.U,{expanded:s,onToggle:v,id:`accordion-${a}`,variant:r?"primary":"secondary"},e.createElement(Et.B,{title:Y()(S),description:`${y({id:"Settings.permissions.category"},{category:S})} ${n==="plugins"?"plugin":n}`}),e.createElement(St.v,null,e.createElement(L.x,{padding:6},o.map(({actions:A,subCategoryName:P,subCategoryId:j})=>e.createElement(ro,{key:P,actions:A,categoryName:S,isFormDisabled:l,subCategoryName:P,pathToData:[...p,j]})))))};Rn.defaultProps={},Rn.propTypes={childrenForm:i().array.isRequired,isOpen:i().bool.isRequired,isFormDisabled:i().bool.isRequired,isWhite:i().bool.isRequired,kind:i().string.isRequired,name:i().string.isRequired,onOpenCategory:i().func.isRequired,pathToData:i().array.isRequired};const co=Rn,Wn=({isFormDisabled:o,kind:n,layout:a})=>{const[s,l]=(0,e.useState)(null),r=c=>{l(c===s?null:c)};return e.createElement(L.x,{padding:6,background:"neutral0"},a.map(({category:c,categoryId:p,childrenForm:y},v)=>e.createElement(co,{key:c,childrenForm:y,kind:n,isFormDisabled:o,isOpen:s===c,isWhite:v%2===1,name:c,onOpenCategory:r,pathToData:[n,p]})))};Wn.propTypes={isFormDisabled:i().bool.isRequired,kind:i().string.isRequired,layout:i().arrayOf(i().shape({category:i().string.isRequired,categoryId:i().string.isRequired,childrenForm:i().arrayOf(i().shape({actions:i().array.isRequired})).isRequired}).isRequired).isRequired};const Gn=Wn,wn=(o,n,a)=>o.find(s=>s.action===n&&s.subject===a),Kn=(o,n=[])=>o.reduce((a,s)=>(a[s.id]=n.indexOf(s.id)!==-1,a),{}),Vn=({children:o},n,a="")=>o.reduce((s,l)=>{if(l.children)return{...s,[l.value]:Vn(l,n,`${a}${l.value}.`)};const r=n.indexOf(`${a}${l.value}`)!==-1;return s[l.value]=r,s},{}),uo=(o,n,a)=>o.reduce((s,l)=>{const r=n.properties.find(({value:c})=>c===l);if(r){const c=(0,C.get)(a,["properties",r.value],[]),p=Vn(r,c);s.properties[l]=p}return s},{properties:{}}),mo=(o,n)=>n.reduce((a,s)=>{const l=o.find(({uid:r})=>r===s)||null;return l&&(a[s]=l),a},{}),Hn=({subjects:o},n,a,s=[])=>n.reduce((l,r)=>{const c=r.subjects,p=mo(o,c);if((0,C.isEmpty)(p))return l;const y=Object.keys(p).reduce((v,S)=>{const{actionId:A,applyToProperties:P}=r,z=p[S].properties.map(({value:de})=>de).every(de=>(P||[]).indexOf(de)===-1),D=wn(s,A,S),F=Kn(a,(0,C.get)(D,"conditions",[]));if((0,C.isEmpty)(P)||z)return(0,C.set)(v,[S,A],{properties:{enabled:D!==void 0},conditions:F}),v;const G=uo(P,p[S],D);return(0,C.set)(v,[S,A],{...G,conditions:F}),v},{});return(0,C.merge)(l,y)},{}),po=(o,n,a)=>o.reduce((s,l)=>{const r=wn(a,l.action,null);return s[l.action]={properties:{enabled:r!==void 0},conditions:Kn(n,(0,C.get)(r,"conditions",[]))},s},{}),go=(o,n,a)=>o.reduce((s,l)=>(s[l.subCategoryId]=po(l.actions,n,a),s),{}),Xn=(o,n,a=[])=>o.reduce((s,{categoryId:l,childrenForm:r})=>{const c=go(r,n,a);return s[l]=c,s},{}),Qn=o=>o.split(" ").join("-"),Yn=(o,n)=>(0,C.chain)(o).groupBy(n).map((a,s)=>({category:s,categoryId:Qn(s),childrenForm:(0,C.chain)(a).groupBy("subCategory").map((l,r)=>({subCategoryName:r,subCategoryId:Qn(r),actions:l})).value()})).value(),fo=(o,n)=>{const{conditions:a,sections:{collectionTypes:s,singleTypes:l,plugins:r,settings:c}}=o,p={collectionTypes:s,singleTypes:l,plugins:Yn(r,"plugin"),settings:Yn(c,"category")},y={collectionTypes:Hn(s,s.actions||[],a,n),singleTypes:Hn(l,l.actions||[],a,n),plugins:Xn(p.plugins,a,n),settings:Xn(p.settings,a,n)};return{initialData:y,modifiedData:y,layouts:p}},Jn=o=>Object.keys(o).reduce((n,a)=>{const s=o[a];if((0,C.isObject)(s)&&!(0,C.has)(s,"conditions"))return{...n,[a]:Jn(s)};if((0,C.isObject)(s)&&(0,C.has)(s,"conditions")&&!ft((0,C.omit)(s,"conditions")).some(r=>r)){const r=Object.keys(s.conditions).reduce((c,p)=>(c[p]=!1,c),{});return{...n,[a]:{...s,conditions:r}}}return n[a]=s,n},{}),Mn=Jn,qn=(o,n)=>Object.keys(o).reduce((a,s)=>{const l=o[s];return s==="conditions"?(a[s]=l,a):(0,C.isObject)(l)?{...a,[s]:qn(l,n)}:(a[s]=n,a)},{}),en=qn,ho={initialData:{},modifiedData:{},layouts:{}},Co=(o,n)=>(0,x.default)(o,a=>{switch(n.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:s,actionId:l,value:r}=n,c=["modifiedData",s];Object.keys((0,C.get)(o,c)).forEach(p=>{const y=(0,C.get)(o,[...c,p,l],void 0);if(y){let v=en(y,r);if(!r&&v.conditions){const S=en(v.conditions,!1);v={...v,conditions:S}}(0,C.set)(a,[...c,p,l],v)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:s,propertyName:l,rowName:r,value:c}=n;let p=(0,C.cloneDeep)(o.modifiedData);const y=s.split(".."),v=(0,C.get)(p,y,{});Object.keys(v).forEach(S=>{if((0,C.has)(v[S],`properties.${l}`)){const A=(0,C.get)(v,[S,"properties",l,r]),P=[...y,S,"properties",l,r];if(!(0,C.isObject)(A))(0,C.set)(p,P,c);else{const j=en(A,c);(0,C.set)(p,P,j)}}}),c||(p=Mn(p)),(0,C.set)(a,"modifiedData",p);break}case"ON_CHANGE_CONDITIONS":{Object.entries(n.conditions).forEach(s=>{const[l,r]=s;(0,C.set)(a,["modifiedData",...l.split(".."),"conditions"],r)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let s=(0,C.cloneDeep)(o.modifiedData);(0,C.set)(s,[...n.keys.split("..")],n.value),n.value||(s=Mn(s)),(0,C.set)(a,"modifiedData",s);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:s,value:l}=n,r=[...s.split("..")];let c=(0,C.cloneDeep)(o.modifiedData);const p=(0,C.get)(c,r,{}),y=en(p,l);(0,C.set)(c,r,y),l||(c=Mn(c)),(0,C.set)(a,["modifiedData"],c);break}case"RESET_FORM":{a.modifiedData=o.initialData;break}case"SET_FORM_AFTER_SUBMIT":{a.initialData=o.modifiedData;break}default:return a}}),Dn=o=>Object.entries(o).filter(([,n])=>n).map(([n])=>n),Eo=o=>{const[n,{conditions:a}]=o;return{action:n,subject:null,conditions:Dn(a),properties:{}}},yo=o=>Object.values(o).reduce((n,a)=>{const s=Object.entries(a).reduce((l,r)=>{const[,{properties:{enabled:c}}]=r;if(!c)return l;const p=Eo(r);return l.push(p),l},[]);return[...n,...s]},[]),_n=o=>Object.values(o).reduce((n,a)=>{const s=yo(a);return[...n,...s]},[]),eo=(o,n="")=>Object.entries(o).reduce((a,s)=>{const[l,r]=s;return(0,C.isObject)(r)?[...a,...eo(r,`${n}${l}.`)]:(r&&!(0,C.isObject)(r)&&a.push(`${n}${l}`),a)},[]),vo=(o,n,{conditions:a,properties:s})=>Object.entries(s).reduce((l,r)=>{const[c,p]=r;return l.properties[c]=eo(p),l},{action:o,subject:n,conditions:Dn(a),properties:{}}),So=(o,n,{conditions:a})=>({action:o,subject:n,properties:{},conditions:Dn(a)}),bo=(o,n)=>Object.entries(n).reduce((s,l)=>{const[r,c]=l;if(!ft(c).some(v=>v))return s;if(!(0,C.has)(c,"properties.enabled")){const v=vo(r,o,c);return[...s,v]}if(!c.properties.enabled)return s;const y=So(r,o,c);return s.push(y),s},[]),to=o=>Object.entries(o).reduce((a,s)=>{const[l,r]=s,c=bo(l,r);return[...a,...c]},[]),To=o=>{const n=_n(o.plugins),a=_n(o.settings),s=to(o.collectionTypes),l=to(o.singleTypes);return[...n,...a,...s,...l]},Ao=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}],Ln=(0,e.forwardRef)(({layout:o,isFormDisabled:n,permissions:a},s)=>{const[{initialData:l,layouts:r,modifiedData:c},p]=(0,e.useReducer)(Co,ho,()=>fo(o,a)),{formatMessage:y}=(0,H.useIntl)();(0,e.useImperativeHandle)(s,()=>({getPermissions(){const I=(0,te.difference)(l.collectionTypes,c.collectionTypes),z=(0,te.difference)(l.singleTypes,c.singleTypes),D={...I,...z};let F;return tt()(D)?F=!1:F=Object.values(D).some(G=>Object.values(G).some(de=>Ze()(de,"conditions"))),{permissionsToSend:To(c),didUpdateConditions:F}},resetForm(){p({type:"RESET_FORM"})},setFormAfterSubmit(){p({type:"SET_FORM_AFTER_SUBMIT"})}}));const v=(I,z,D,F)=>{p({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:I,propertyName:z,rowName:D,value:F})},S=(I,z,D)=>{p({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:I,actionId:z,value:D})},A=I=>{p({type:"ON_CHANGE_CONDITIONS",conditions:I})},P=(0,e.useCallback)(({target:{name:I,value:z}})=>{p({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:I,value:z})},[]),j=(0,e.useCallback)(({target:{name:I,value:z}})=>{p({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:I,value:z})},[]);return e.createElement(ot,{value:{availableConditions:o.conditions,modifiedData:c,onChangeConditions:A,onChangeSimpleCheckbox:P,onChangeParentCheckbox:j,onChangeCollectionTypeLeftActionRowCheckbox:v,onChangeCollectionTypeGlobalActionCheckbox:S}},e.createElement(Q.v,{id:"tabs",label:y({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(Xe.m,null,Ao.map(I=>e.createElement(Xe.O,{key:I.id},y({id:I.labelId,defaultMessage:I.defaultMessage})))),e.createElement(se.n,{style:{position:"relative"}},e.createElement(se.x,null,e.createElement(Fe,{layout:r.collectionTypes,kind:"collectionTypes",isFormDisabled:n})),e.createElement(se.x,null,e.createElement(Fe,{layout:r.singleTypes,kind:"singleTypes",isFormDisabled:n})),e.createElement(se.x,null,e.createElement(Gn,{layout:r.plugins,kind:"plugins",isFormDisabled:n})),e.createElement(se.x,null,e.createElement(Gn,{layout:r.settings,kind:"settings",isFormDisabled:n})))))});Ln.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},Ln.propTypes={layout:i().object,isFormDisabled:i().bool.isRequired,permissions:i().array};const Ro=(0,e.memo)(Ln)},34341:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!0},67500:(ee,b,t)=>{t.d(b,{Z:()=>e});const e=()=>"todo empty role"},52351:(ee,b,t)=>{t.d(b,{Z:()=>T});var e=t(67294),h=t(45697),i=t.n(h),te=t(41580),Q=t(11047),Xe=t(47144),se=t(18374),Pe=t(75515),Ze=t(12028),Ie=t(68547),tt=t.n(Ie),H=t(97132);const L=({id:Te,name:$,description:Ae,usersCount:W,icons:je,rowIndex:_})=>{const{formatMessage:B}=(0,H.useIntl)(),Qe=B({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:W});return e.createElement(Xe.Tr,{"aria-rowindex":_,key:Te,...(0,Ie.onRowClick)({fn:je[1].onClick})},e.createElement(se.Td,{maxWidth:(0,Ie.pxToRem)(130)},e.createElement(Pe.Z,{ellipsis:!0,textColor:"neutral800"},$)),e.createElement(se.Td,{maxWidth:(0,Ie.pxToRem)(250)},e.createElement(Pe.Z,{ellipsis:!0,textColor:"neutral800"},Ae)),e.createElement(se.Td,null,e.createElement(Pe.Z,{textColor:"neutral800"},Qe)),e.createElement(se.Td,null,e.createElement(Q.k,{justifyContent:"flex-end",...Ie.stopPropagation},je.map((w,f)=>w?e.createElement(te.x,{key:w.label,paddingLeft:f===0?0:1},e.createElement(Ze.h,{onClick:w.onClick,label:w.label,noBorder:!0,icon:w.icon})):null))))};L.propTypes={id:i().number.isRequired,name:i().string.isRequired,description:i().string.isRequired,usersCount:i().number.isRequired,icons:i().array.isRequired,rowIndex:i().number.isRequired};const T=L},85302:(ee,b,t)=>{t.d(b,{Z:()=>qe});var e=t(67294),h=t(68547),i=t(87751),te=t(63852),Q=t(96315),Xe=t(20022),se=t(4585),Pe=t(65186),Ze=t(29728),Ie=t(67838),tt=t(49066),H=t(11057),L=t(49386),T=t(63985),Te=t(47144),$=t(18374),Ae=t(550),W=t(75515),je=t(185),_=t(63237),B=t(97132),Qe=t(49656),w=t(52351),f=t(67500),ze=t(45697),ie=t.n(ze),We=t(71893),Ge=t(44034),ct=t(25896),nt=t(12028),we=t(80994),at=t(41580),st=t(11047),it=t(7681),ne=t(17772),Ye=t(70968);const le=t.p+"6d21938306785f176538.png",x=t.p+"617f9c948fa79e6d73bd.png",Ce=We.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:R})=>(0,h.setHexOpacity)(R.colors.neutral800,.2)};
  padding: 0 ${({theme:R})=>R.spaces[8]};
`,N=(0,We.default)(st.k)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,Ee=(0,We.default)(it.K)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,Y=(0,We.default)(at.x)`
  position: absolute;
  right: ${({theme:R})=>R.spaces[4]};
  top: ${({theme:R})=>R.spaces[4]};
`,oe=({onClose:R,isOpen:Z})=>{(0,h.useLockScroll)(Z);const{formatMessage:k}=(0,B.useIntl)();return Z?e.createElement(Ge.h,null,e.createElement(Ce,{onClick:R},e.createElement(ct.i,{onEscape:R},e.createElement(N,{onClick:ae=>ae.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:le,alt:"air-balloon"}),e.createElement(Y,null,e.createElement(nt.h,{onClick:R,"aria-label":"Close",icon:e.createElement(Ye.default,null)})),e.createElement(Ee,{spacing:6},e.createElement(W.Z,{fontWeight:"bold",textColor:"primary600"},k({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(it.K,{spacing:2},e.createElement(W.Z,{variant:"alpha",as:"h2",id:"upgrade-plan"},k({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement(W.Z,null,k({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(we.Q,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(ne.Z,null)},k({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:x,alt:"upgrade-arrow"}))))):null};oe.propTypes={onClose:ie().func.isRequired,isOpen:ie().bool.isRequired};const Ue=oe;var Oe=t(48474);const re=()=>{const{roles:R,isLoading:Z}=(0,Oe.bF)(),k=(0,h.useQuery)(),ae=decodeURIComponent(k.get("_q")||""),K=(0,te.ZP)(R,ae,{keys:["name","description"]});return{isLoading:Z,sortedRoles:K}},Re=()=>{const{formatMessage:R}=(0,B.useIntl)(),[Z,k]=(0,e.useState)(!1),{trackUsage:ae}=(0,h.useTracking)(),{push:K}=(0,Qe.useHistory)(),me=(0,e.useCallback)(M=>{K(`/settings/roles/${M}`)},[K]),Me=(0,e.useCallback)(()=>{k(M=>!M)},[]),$e=(0,e.useCallback)(()=>{ae("didShowRBACUpgradeModal"),k(!0)},[ae]),dt=(0,e.useCallback)(M=>[{onClick:Me,label:R({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(Pe.Z,null)},{onClick:()=>me(M.id),label:R({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(se.Z,null)},{onClick:Me,label:R({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Xe.default,null)}],[R,Me,me]);return{isModalOpen:Z,handleToggleModalForCreatingRole:$e,handleToggle:Me,getIcons:dt}},Je=()=>{const{formatMessage:R}=(0,B.useIntl)();(0,h.useFocusWhenNavigate)();const{sortedRoles:Z,isLoading:k}=re(),{isModalOpen:ae,handleToggle:K,handleToggleModalForCreatingRole:me,getIcons:Me}=Re(),$e=Z.length+1,dt=5;return e.createElement(je.o,null,e.createElement(h.SettingsPageTitle,{name:"Roles"}),e.createElement(Ie.T,{primaryAction:e.createElement(Ze.z,{onClick:me,startIcon:e.createElement(Q.default,null),size:"S"},R({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:R({id:"global.roles",defaultMessage:"roles"}),subtitle:R({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(tt.D,null,e.createElement(H.i,{colCount:dt,rowCount:$e,footer:e.createElement(L.c,{onClick:me,icon:e.createElement(Q.default,null)},R({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(T.h,null,e.createElement(Te.Tr,null,e.createElement($.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},R({id:"global.name",defaultMessage:"Name"}))),e.createElement($.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},R({id:"global.description",defaultMessage:"Description"}))),e.createElement($.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},R({id:"global.users",defaultMessage:"Users"}))),e.createElement($.Th,null,e.createElement(_.T,null,R({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Ae.p,null,Z?.map((M,ye)=>e.createElement(w.Z,{key:M.id,id:M.id,name:M.name,description:M.description,usersCount:M.usersCount,icons:Me(M),rowIndex:ye+2})))),!$e&&!k&&e.createElement(f.Z,null)),e.createElement(Ue,{isOpen:ae,onClose:K}))},qe=()=>e.createElement(h.CheckPagePermissions,{permissions:i.Z.settings.roles.main},e.createElement(Je,null))},35301:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=[]},26789:(ee,b,t)=>{t.d(b,{Z:()=>it});var e=t(67294),h=t(47292),i=t(68547),te=t(41580),Q=t(29728),Xe=t(67838),se=t(49066),Pe=t(11276),Ze=t(74571),Ie=t(185),tt=t(11047),H=t(7681),L=t(75515),T=t(16364),Te=t(64256),$=t(67109),Ae=t(80831),W=t(27361),je=t.n(W),_=t(41609),B=t.n(_),Qe=t(97132),w=t(49656),f=t(71893),ze=t(28834),ie=t(48474),We=t(87751),Ge=t(53209);const nt=Ge.Ry().shape({name:Ge.Z_().required(i.translatedErrors.required),description:Ge.Z_().required(i.translatedErrors.required)});var we=t(25108);const at=f.default.div`
  border: 1px solid ${({theme:ne})=>ne.colors.primary200};
  background: ${({theme:ne})=>ne.colors.primary100};
  padding: ${({theme:ne})=>`${ne.spaces[2]} ${ne.spaces[4]}`};
  color: ${({theme:ne})=>ne.colors.primary600};
  border-radius: ${({theme:ne})=>ne.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,st=()=>{const ne=(0,i.useNotification)(),{lockApp:Ye,unlockApp:le}=(0,i.useOverlayBlocker)(),{formatMessage:x}=(0,Qe.useIntl)(),[Ce,N]=(0,e.useState)(!1),{replace:Ee}=(0,w.useHistory)(),Y=(0,e.useRef)(),{trackUsage:oe}=(0,i.useTracking)(),Ue=(0,w.useRouteMatch)("/settings/roles/duplicate/:id"),Oe=je()(Ue,"params.id",null),{isLoading:re,data:Re}=(0,ie.U_)(),{permissions:Ke,isLoading:Je}=(0,ie.Dq)(Oe),C=R=>{Ye(),N(!0),oe(Oe?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,i.request)("/admin/roles",{method:"POST",body:R})).then(async Z=>{const{permissionsToSend:k}=Y.current.getPermissions();return oe(Oe?"didDuplicateRole":"didCreateNewRole"),Z.data.id&&!B()(k)&&await(0,i.request)(`/admin/roles/${Z.data.id}/permissions`,{method:"PUT",body:{permissions:k}}),Z}).then(Z=>{N(!1),ne({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),Ee(`/settings/roles/${Z.data.id}`)}).catch(Z=>{we.error(Z),N(!1),ne({type:"warning",message:{id:"notification.error"}})}).finally(()=>{le()})},qe=`${x({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,h.format)(new Date,"PPP")}`;return e.createElement(Ie.o,null,e.createElement(i.SettingsPageTitle,{name:"Roles"}),e.createElement(Ae.Formik,{initialValues:{name:"",description:qe},onSubmit:C,validationSchema:nt,validateOnChange:!1},({handleSubmit:R,values:Z,errors:k,handleReset:ae,handleChange:K})=>e.createElement(i.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(Xe.T,{primaryAction:e.createElement(H.K,{horizontal:!0,spacing:2},e.createElement(Q.z,{variant:"secondary",onClick:()=>{ae(),Y.current.resetForm()},size:"L"},x({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(Q.z,{onClick:R,loading:Ce,size:"L"},x({id:"global.save",defaultMessage:"Save"}))),title:x({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:x({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(i.Link,{startIcon:e.createElement($.Z,null),to:"/settings/roles"},x({id:"global.back",defaultMessage:"Back"}))}),e.createElement(se.D,null,e.createElement(H.K,{spacing:6},e.createElement(te.x,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(H.K,{spacing:4},e.createElement(tt.k,{justifyContent:"space-between"},e.createElement(te.x,null,e.createElement(te.x,null,e.createElement(L.Z,{fontWeight:"bold"},x({id:"global.details",defaultMessage:"Details"}))),e.createElement(te.x,null,e.createElement(L.Z,{variant:"pi",textColor:"neutral600"},x({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(at,null,x({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(Pe.r,{gap:4},e.createElement(Ze.P,{col:6},e.createElement(T.o,{name:"name",error:k.name&&x({id:k.name}),label:x({id:"global.name",defaultMessage:"Name"}),onChange:K,value:Z.name})),e.createElement(Ze.P,{col:6},e.createElement(Te.g,{label:x({id:"global.description",defaultMessage:"Description"}),name:"description",error:k.description&&x({id:k.description}),onChange:K},Z.description))))),!re&&!Je?e.createElement(te.x,{shadow:"filterShadow",hasRadius:!0},e.createElement(ze.Z,{isFormDisabled:!1,ref:Y,permissions:Ke,layout:Re})):e.createElement(te.x,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(i.LoadingIndicatorPage,null))))))))};function it(){return e.createElement(i.CheckPagePermissions,{permissions:We.Z.settings.roles.create},e.createElement(st,null))}},53273:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},74512:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},76766:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},20591:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},85822:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},8629:(ee,b,t)=>{t.d(b,{Z:()=>h});const h=!1},64527:(ee,b,t)=>{t.d(b,{Z:()=>le});var e=t(67294),h=t(68547),i=t(87751),te=t(96315),Q=t(20022),Xe=t(65186),se=t(4585),Pe=t(29728),Ze=t(67838),Ie=t(36989),tt=t(49066),H=t(63237),L=t(185),T=t(11057),Te=t(49386),$=t(63985),Ae=t(47144),W=t(18374),je=t(550),_=t(75515),B=t(96486),Qe=t(63852),w=t(97132),f=t(49656),ze=t(48474),ie=t(67500),We=t(52351),Ge=t(18172);const ct={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},we=(x,Ce)=>(0,Ge.default)(x,N=>{switch(Ce.type){case"ON_REMOVE_ROLES":{N.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{N.shouldRefetchData=!0,N.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{N.shouldRefetchData=!1,N.roleToDelete=null,N.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{N.roleToDelete=Ce.id;break}default:return N}}),at=()=>{(0,h.useFocusWhenNavigate)();const{isLoading:x,allowedActions:{canCreate:Ce,canDelete:N,canRead:Ee,canUpdate:Y}}=(0,h.useRBAC)(i.Z.settings.roles),{getData:oe,roles:Ue,isLoading:Oe}=(0,ze.bF)(!1),[{query:re}]=(0,h.useQueryParams)(),Re=re?._q||"",Ke=(0,Qe.ZP)(Ue,Re,{keys:["name","description"]});return(0,e.useEffect)(()=>{!x&&Ee&&oe()},[x,Ee,oe]),{isLoadingForPermissions:x,canCreate:Ce,canDelete:N,canRead:Ee,canUpdate:Y,isLoading:Oe,getData:oe,sortedRoles:Ke,roles:Ue}},st=({getData:x,canCreate:Ce,canDelete:N,canUpdate:Ee})=>{const{formatMessage:Y}=(0,w.useIntl)(),oe=(0,h.useNotification)(),[Ue,Oe]=(0,e.useState)(!1),{push:re}=(0,f.useHistory)(),[{selectedRoles:Re,showModalConfirmButtonLoading:Ke,roleToDelete:Je},C]=(0,e.useReducer)(we,ct),{post:qe}=(0,h.getFetchClient)(),R=async()=>{try{C({type:"ON_REMOVE_ROLES"}),await qe("/admin/roles/batch-delete",{ids:[Je]}),await x(),C({type:"RESET_DATA_TO_DELETE"})}catch(M){const ye=(0,B.get)(M,["response","payload","data","ids"],null);if(ye&&Array.isArray(ye)){const ut=ye.join(`
`);oe({type:"warning",message:ut})}else oe({type:"warning",message:{id:"notification.error"}})}K()},Z=(0,e.useCallback)(M=>{re(`/settings/roles/duplicate/${M}`)},[re]),k=()=>re("/settings/roles/new"),ae=(0,e.useCallback)(M=>{C({type:"SET_ROLE_TO_DELETE",id:M}),K()},[]),K=()=>Oe(M=>!M),me=(0,e.useCallback)(M=>{re(`/settings/roles/${M}`)},[re]),Me=(0,e.useCallback)((M,ye)=>{M.preventDefault(),M.stopPropagation(),ye.usersCount?oe({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):ae(ye.id)},[oe,ae]),$e=(0,e.useCallback)((M,ye)=>{M.preventDefault(),M.stopPropagation(),Z(ye.id)},[Z]),dt=(0,e.useCallback)(M=>[...Ce?[{onClick:ye=>$e(ye,M),label:Y({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(Xe.Z,null)}]:[],...Ee?[{onClick:()=>me(M.id),label:Y({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(se.Z,null)}]:[],...N?[{onClick:ye=>Me(ye,M),label:Y({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Q.default,null)}]:[]],[Y,Me,$e,me,Ce,Ee,N]);return{handleNewRoleClick:k,getIcons:dt,selectedRoles:Re,isWarningDeleteAllOpened:Ue,showModalConfirmButtonLoading:Ke,handleToggleModal:K,handleDeleteData:R}},ne=()=>{const{formatMessage:x}=(0,w.useIntl)(),{isLoadingForPermissions:Ce,canCreate:N,canRead:Ee,canDelete:Y,canUpdate:oe,isLoading:Ue,getData:Oe,sortedRoles:re}=at(),{handleNewRoleClick:Re,getIcons:Ke,isWarningDeleteAllOpened:Je,showModalConfirmButtonLoading:C,handleToggleModal:qe,handleDeleteData:R}=st({getData:Oe,canCreate:N,canDelete:Y,canUpdate:oe}),Z=re.length+1,k=6;if(Ce)return e.createElement(L.o,null,e.createElement(h.LoadingIndicatorPage,null));const ae=x({id:"global.roles",defaultMessage:"roles"});return e.createElement(L.o,null,e.createElement(h.SettingsPageTitle,{name:"Roles"}),e.createElement(Ze.T,{primaryAction:N?e.createElement(Pe.z,{onClick:Re,startIcon:e.createElement(te.default,null),size:"S"},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:ae,subtitle:x({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),Ee&&e.createElement(Ie.Z,{startActions:e.createElement(h.SearchURLQuery,{label:x({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:ae})})}),Ee&&e.createElement(tt.D,null,e.createElement(T.i,{colCount:k,rowCount:Z,footer:N?e.createElement(Te.c,{onClick:Re,icon:e.createElement(te.default,null)},x({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement($.h,null,e.createElement(Ae.Tr,{"aria-rowindex":1},e.createElement(W.Th,null,e.createElement(_.Z,{variant:"sigma",textColor:"neutral600"},x({id:"global.name",defaultMessage:"Name"}))),e.createElement(W.Th,null,e.createElement(_.Z,{variant:"sigma",textColor:"neutral600"},x({id:"global.description",defaultMessage:"Description"}))),e.createElement(W.Th,null,e.createElement(_.Z,{variant:"sigma",textColor:"neutral600"},x({id:"global.users",defaultMessage:"Users"}))),e.createElement(W.Th,null,e.createElement(H.T,null,x({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(je.p,null,re?.map((K,me)=>e.createElement(We.Z,{key:K.id,id:K.id,name:K.name,description:K.description,usersCount:K.usersCount,icons:Ke(K),rowIndex:me+2})))),!Z&&!Ue&&e.createElement(ie.Z,null)),e.createElement(h.ConfirmDialog,{isOpen:Je,onConfirm:R,isConfirmButtonLoading:C,onToggleDialog:qe}))},le=()=>e.createElement(h.CheckPagePermissions,{permissions:i.Z.settings.roles.main},e.createElement(ne,null))},5420:(ee,b,t)=>{t.d(b,{Z:()=>h});const e=[];strapi.features.isEnabled(strapi.features.SSO)&&e.push({async Component(){return await t.e(302).then(t.bind(t,40316))},to:"/settings/single-sign-on",exact:!0}),strapi.features.isEnabled(strapi.features.AUDIT_LOGS)&&e.push({async Component(){return await Promise.all([t.e(4432),t.e(2812)]).then(t.bind(t,35915))},to:"/settings/audit-logs",exact:!0});const h=e}}]);
